
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Main</title><meta name="generator" content="MATLAB 9.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-11-11"><meta name="DC.source" content="Main.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Maximum likelihood estimation</a></li><li><a href="#2">Step 1: DGP %%</a></li><li><a href="#3">Step 2: Estimation %%</a></li><li><a href="#4">Step 3: Results %%</a></li></ul></div><h2 id="1">Maximum likelihood estimation</h2><p>Autocorrelation Y(t) = b1 + b2*x2(t) + e(t) e(t) = rho*e(t-1) + v(t), v(t)</p><pre class="codeinput">clear;
clc;
addpath(<span class="string">'C:\Users\&#51060;&#44148;&#55148;\OneDrive - &#51204;&#48513;&#45824;&#54617;&#44368;\&#47928;&#49436;\MATLAB\M_library'</span>);
</pre><pre class="codeoutput">&#44221;&#44256;: &#51060;&#47492;&#51060; &#51316;&#51116;&#54616;&#51648; &#50506;&#44144;&#45208; &#46356;&#47113;&#53552;&#47532;&#44032; &#50500;&#45784;: C:\Users\&#51060;&#44148;&#55148;\OneDrive - &#51204;&#48513;&#45824;&#54617;&#44368;\&#47928;
&#49436;\MATLAB\M_library 
</pre><h2 id="2">Step 1: DGP %%</h2><pre class="codeinput">T = 500;
sig2 = 1;
rho = 0.5;
b1 = 0.3;
b2 = 0.2;

x1m = ones(T,1);
x2m = randn(T,1)*2;

em = zeros(T,1);
ym = zeros(T,1);
eL = sqrt(sig2/(1-rho))*randn(1,1);
<span class="keyword">for</span> t = 1:T

    et = rho*eL + sqrt(sig2)*randn(1,1);
    yt = b1*x1m(t) + b2*x2m(t) + et;

    em(t) = et;
    ym(t) = yt;

    eL = et;
<span class="keyword">end</span>
</pre><h2 id="3">Step 2: Estimation %%</h2><p>Data</p><pre class="codeinput">Y = ym;
X = [x1m x2m];

Data = [Y X];

T = rows(X);
k = cols(X);

<span class="comment">% initial value</span>
theta0 = [0;0;0.1;0.1];

<span class="comment">% index</span>
index = [1;2;3;4];
printi = 1;

<span class="comment">% Optimization</span>
[thetamx, fmax, Vj, Vinv] = SA_Newton(@lnlik,@paramconst,theta0,Data,printi,index);

<span class="comment">% Compute t-value and p-value</span>
diag_cov = diag(Vj);
stde = sqrt(diag_cov);
t_val = thetamx./stde;
p_val = 2*(1 - cdf(<span class="string">'t'</span>, abs(t_val), T-k));
</pre><pre class="codeoutput">-------------------------------------
initial function value  -2953.2315
current temperature  1
current scale factor  10  60  10  10
M-H rate in stage  1    0  0  0  0
current function value  -1328.1303
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2992
    2.0000         0
    3.0000    0.1143
    4.0000    0.2319

-------------------------------------
Computing time of each SA iteration in min is =  7.7517e-05
Total SA computing time in hours is =  1.9379e-05
Remaining SA computing time in min is =  0.0010852
Remaining SA computing time in hours is =  1.8087e-05
Remaining SA computing time in days is =  7.5363e-07
==========================================================================
current temperature  0.9
current scale factor  10  60  10  10
M-H rate in stage  2    53.3333            0            0            0
current function value  -693.465
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2578
    2.0000    0.0934
    3.0000    0.3988
    4.0000    0.9323

-------------------------------------
Computing time of each SA iteration in min is =  3.9287e-05
Total SA computing time in hours is =  9.8217e-06
Remaining SA computing time in min is =  0.00051073
Remaining SA computing time in hours is =  8.5121e-06
Remaining SA computing time in days is =  3.5467e-07
==========================================================================
current temperature  0.81
current scale factor  10  60  10  10
M-H rate in stage  3    0            0            0      48.1481
current function value  -678.251
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.3160
    2.0000    0.1943
    3.0000    0.4281
    4.0000    0.9254

-------------------------------------
Computing time of each SA iteration in min is =  5.6802e-05
Total SA computing time in hours is =  1.42e-05
Remaining SA computing time in min is =  0.00068162
Remaining SA computing time in hours is =  1.136e-05
Remaining SA computing time in days is =  4.7335e-07
==========================================================================
current temperature  0.729
current scale factor  10  60  10  10
M-H rate in stage  4    0            0      37.1429            0
current function value  -677.997
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2965
    2.0000    0.1911
    3.0000    0.4020
    4.0000    0.8727

-------------------------------------
Computing time of each SA iteration in min is =  0.00010938
Total SA computing time in hours is =  2.7346e-05
Remaining SA computing time in min is =  0.0012032
Remaining SA computing time in hours is =  2.0054e-05
Remaining SA computing time in days is =  8.3558e-07
==========================================================================
current temperature  0.6561
current scale factor  10  60  10  10
M-H rate in stage  5    0      63.6364            0            0
current function value  -677.958
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2623
    2.0000    0.1942
    3.0000    0.4144
    4.0000    0.8657

-------------------------------------
Computing time of each SA iteration in min is =  0.00010783
Total SA computing time in hours is =  2.6958e-05
Remaining SA computing time in min is =  0.0010783
Remaining SA computing time in hours is =  1.7972e-05
Remaining SA computing time in days is =  7.4882e-07
==========================================================================
current temperature  0.59049
current scale factor  10  60  10  10
M-H rate in stage  6    0      66.6667            0            0
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00013591
Total SA computing time in hours is =  3.3977e-05
Remaining SA computing time in min is =  0.0012232
Remaining SA computing time in hours is =  2.0386e-05
Remaining SA computing time in days is =  8.4944e-07
==========================================================================
current temperature  0.53144
current scale factor  10  60  10  10
M-H rate in stage  7    64.3836            0            0            0
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00015745
Total SA computing time in hours is =  3.9361e-05
Remaining SA computing time in min is =  0.0012596
Remaining SA computing time in hours is =  2.0993e-05
Remaining SA computing time in days is =  8.7469e-07
==========================================================================
current temperature  0.4783
current scale factor  10  60  10  10
M-H rate in stage  8    0            0      32.4324            0
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00018599
Total SA computing time in hours is =  4.6497e-05
Remaining SA computing time in min is =  0.0013019
Remaining SA computing time in hours is =  2.1698e-05
Remaining SA computing time in days is =  9.041e-07
==========================================================================
current temperature  0.43047
current scale factor  10      31.9466           10           10
M-H rate in stage  9    0      75.2688            0            0
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00021534
Total SA computing time in hours is =  5.3835e-05
Remaining SA computing time in min is =  0.001292
Remaining SA computing time in hours is =  2.1534e-05
Remaining SA computing time in days is =  8.9725e-07
==========================================================================
current temperature  0.38742
current scale factor  10      31.9466           10           10
M-H rate in stage  10    0            0      32.6087            0
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00023659
Total SA computing time in hours is =  5.9148e-05
Remaining SA computing time in min is =  0.001183
Remaining SA computing time in hours is =  1.9716e-05
Remaining SA computing time in days is =  8.215e-07
==========================================================================
current temperature  0.34868
current scale factor  10      31.9466           10           10
M-H rate in stage  11    0            0            0      39.8148
current function value  -677.8729
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2879
    2.0000    0.1939
    3.0000    0.4146
    4.0000    0.8942

-------------------------------------
Computing time of each SA iteration in min is =  0.00026001
Total SA computing time in hours is =  6.5002e-05
Remaining SA computing time in min is =  0.00104
Remaining SA computing time in hours is =  1.7334e-05
Remaining SA computing time in days is =  7.2225e-07
==========================================================================
current temperature  0.31381
current scale factor  10      31.9466           10           10
M-H rate in stage  12    0            0      26.5625            0
current function value  -677.8453
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2756
    2.0000    0.1992
    3.0000    0.4127
    4.0000    0.8908

-------------------------------------
Computing time of each SA iteration in min is =  0.00028497
Total SA computing time in hours is =  7.1243e-05
Remaining SA computing time in min is =  0.00085492
Remaining SA computing time in hours is =  1.4249e-05
Remaining SA computing time in days is =  5.9369e-07
==========================================================================
current temperature  0.28243
current scale factor  10      31.9466           10           10
M-H rate in stage  13    33.6538            0            0            0
current function value  -677.8453
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2756
    2.0000    0.1992
    3.0000    0.4127
    4.0000    0.8908

-------------------------------------
Computing time of each SA iteration in min is =  0.00030991
Total SA computing time in hours is =  7.7478e-05
Remaining SA computing time in min is =  0.00061983
Remaining SA computing time in hours is =  1.033e-05
Remaining SA computing time in days is =  4.3044e-07
==========================================================================
current temperature  0.25419
current scale factor  10      31.9466           10           10
M-H rate in stage  14    0      27.8912            0            0
current function value  -677.8453
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2756
    2.0000    0.1992
    3.0000    0.4127
    4.0000    0.8908

-------------------------------------
Computing time of each SA iteration in min is =  0.00038674
Total SA computing time in hours is =  9.6685e-05
Remaining SA computing time in min is =  0.00038674
Remaining SA computing time in hours is =  6.4457e-06
Remaining SA computing time in days is =  2.6857e-07
==========================================================================
current temperature  0.22877
current scale factor  10      31.9466           10           10
M-H rate in stage  15    0            0            0      34.3066
current function value  -677.8453
-------------------------------------
     indices  argmax  
-------------------------------------
    1.0000    0.2756
    2.0000    0.1992
    3.0000    0.4127
    4.0000    0.8908

-------------------------------------
Computing time of each SA iteration in min is =  0.00038148
Total SA computing time in hours is =  9.537e-05
Remaining SA computing time in min is =  0
Remaining SA computing time in hours is =  0
Remaining SA computing time in days is =  0
==========================================================================
===============================================================================
current DO iteration is 1
current function value -677.838
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2783   -0.9899
    2.0000    0.1985    3.9189
    3.0000    0.4135   -1.0145
    4.0000    0.8883    1.5294

-------------------------------------
Computing time of each DO iteration in min is =  7.8532e-05
Total DO computing time in hours is =  5.2354e-05
Remaining DO computing time in min is =  0.0030627
Remaining DO computing time in hours is =  5.1046e-05
Remaining DO computing time in days is =  2.1269e-06
===============================================================================
===============================================================================
current DO iteration is 2
current function value -677.8361
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2796   -0.4945
    2.0000    0.1982    1.9528
    3.0000    0.4139   -0.5075
    4.0000    0.8871    0.7587

-------------------------------------
Computing time of each DO iteration in min is =  2.4585e-05
Total DO computing time in hours is =  1.639e-05
Remaining DO computing time in min is =  0.00093423
Remaining DO computing time in hours is =  1.557e-05
Remaining DO computing time in days is =  6.4877e-07
===============================================================================
===============================================================================
current DO iteration is 3
current function value -677.8357
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2803   -0.2471
    2.0000    0.1980    0.9749
    3.0000    0.4141   -0.2539
    4.0000    0.8865    0.3779

-------------------------------------
Computing time of each DO iteration in min is =  1.5107e-05
Total DO computing time in hours is =  1.0071e-05
Remaining DO computing time in min is =  0.00055895
Remaining DO computing time in hours is =  9.3158e-06
Remaining DO computing time in days is =  3.8816e-07
===============================================================================
===============================================================================
current DO iteration is 4
current function value -677.8356
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2806   -0.1236
    2.0000    0.1979    0.4869
    3.0000    0.4142   -0.1270
    4.0000    0.8862    0.1886

-------------------------------------
Computing time of each DO iteration in min is =  1.4855e-05
Total DO computing time in hours is =  9.9033e-06
Remaining DO computing time in min is =  0.00053478
Remaining DO computing time in hours is =  8.913e-06
Remaining DO computing time in days is =  3.7137e-07
===============================================================================
===============================================================================
current DO iteration is 5
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2808   -0.0620
    2.0000    0.1979    0.2434
    3.0000    0.4142   -0.0636
    4.0000    0.8861    0.0942

-------------------------------------
Computing time of each DO iteration in min is =  1.482e-05
Total DO computing time in hours is =  9.88e-06
Remaining DO computing time in min is =  0.0005187
Remaining DO computing time in hours is =  8.645e-06
Remaining DO computing time in days is =  3.6021e-07
===============================================================================
===============================================================================
current DO iteration is 6
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2808   -0.0309
    2.0000    0.1978    0.1216
    3.0000    0.4143   -0.0317
    4.0000    0.8860    0.0471

-------------------------------------
Computing time of each DO iteration in min is =  1.5168e-05
Total DO computing time in hours is =  1.0112e-05
Remaining DO computing time in min is =  0.00051572
Remaining DO computing time in hours is =  8.5954e-06
Remaining DO computing time in days is =  3.5814e-07
===============================================================================
===============================================================================
current DO iteration is 7
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0155
    2.0000    0.1978    0.0609
    3.0000    0.4143   -0.0159
    4.0000    0.8860    0.0235

-------------------------------------
Computing time of each DO iteration in min is =  1.5378e-05
Total DO computing time in hours is =  1.0252e-05
Remaining DO computing time in min is =  0.00050749
Remaining DO computing time in hours is =  8.4581e-06
Remaining DO computing time in days is =  3.5242e-07
===============================================================================
===============================================================================
current DO iteration is 8
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0079
    2.0000    0.1978    0.0302
    3.0000    0.4143   -0.0080
    4.0000    0.8860    0.0117

-------------------------------------
Computing time of each DO iteration in min is =  1.494e-05
Total DO computing time in hours is =  9.96e-06
Remaining DO computing time in min is =  0.00047808
Remaining DO computing time in hours is =  7.968e-06
Remaining DO computing time in days is =  3.32e-07
===============================================================================
===============================================================================
current DO iteration is 9
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0038
    2.0000    0.1978    0.0153
    3.0000    0.4143   -0.0040
    4.0000    0.8860    0.0059

-------------------------------------
Computing time of each DO iteration in min is =  1.4773e-05
Total DO computing time in hours is =  9.8489e-06
Remaining DO computing time in min is =  0.00045797
Remaining DO computing time in hours is =  7.6329e-06
Remaining DO computing time in days is =  3.1804e-07
===============================================================================
===============================================================================
current DO iteration is 10
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0018
    2.0000    0.1978    0.0077
    3.0000    0.4143   -0.0020
    4.0000    0.8859    0.0030

-------------------------------------
Computing time of each DO iteration in min is =  1.4823e-05
Total DO computing time in hours is =  9.8822e-06
Remaining DO computing time in min is =  0.0004447
Remaining DO computing time in hours is =  7.4117e-06
Remaining DO computing time in days is =  3.0882e-07
===============================================================================
===============================================================================
current DO iteration is 11
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0010
    2.0000    0.1978    0.0038
    3.0000    0.4143   -0.0009
    4.0000    0.8859    0.0015

-------------------------------------
Computing time of each DO iteration in min is =  1.4748e-05
Total DO computing time in hours is =  9.8322e-06
Remaining DO computing time in min is =  0.0004277
Remaining DO computing time in hours is =  7.1284e-06
Remaining DO computing time in days is =  2.9702e-07
===============================================================================
===============================================================================
current DO iteration is 12
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0005
    2.0000    0.1978    0.0018
    3.0000    0.4143   -0.0005
    4.0000    0.8859    0.0007

-------------------------------------
Computing time of each DO iteration in min is =  1.472e-05
Total DO computing time in hours is =  9.8133e-06
Remaining DO computing time in min is =  0.00041216
Remaining DO computing time in hours is =  6.8693e-06
Remaining DO computing time in days is =  2.8622e-07
===============================================================================
===============================================================================
current DO iteration is 13
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0002
    2.0000    0.1978    0.0009
    3.0000    0.4143   -0.0002
    4.0000    0.8859    0.0004

-------------------------------------
Computing time of each DO iteration in min is =  1.4703e-05
Total DO computing time in hours is =  9.8022e-06
Remaining DO computing time in min is =  0.00039699
Remaining DO computing time in hours is =  6.6165e-06
Remaining DO computing time in days is =  2.7569e-07
===============================================================================
===============================================================================
current DO iteration is 14
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0001
    2.0000    0.1978    0.0006
    3.0000    0.4143   -0.0001
    4.0000    0.8859    0.0002

-------------------------------------
Computing time of each DO iteration in min is =  1.4687e-05
Total DO computing time in hours is =  9.7911e-06
Remaining DO computing time in min is =  0.00038185
Remaining DO computing time in hours is =  6.3642e-06
Remaining DO computing time in days is =  2.6518e-07
===============================================================================
===============================================================================
current DO iteration is 15
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0001
    2.0000    0.1978    0.0003
    3.0000    0.4143   -0.0001
    4.0000    0.8859    0.0001

-------------------------------------
Computing time of each DO iteration in min is =  1.4683e-05
Total DO computing time in hours is =  9.7889e-06
Remaining DO computing time in min is =  0.00036708
Remaining DO computing time in hours is =  6.1181e-06
Remaining DO computing time in days is =  2.5492e-07
===============================================================================
===============================================================================
current DO iteration is 16
current function value -677.8355
current step size 0.00024414
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0000
    2.0000    0.1978    0.0002
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  2.2135e-05
Total DO computing time in hours is =  1.4757e-05
Remaining DO computing time in min is =  0.00053124
Remaining DO computing time in hours is =  8.854e-06
Remaining DO computing time in days is =  3.6892e-07
===============================================================================
===============================================================================
current DO iteration is 17
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0000
    2.0000    0.1978    0.0003
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0001

-------------------------------------
Computing time of each DO iteration in min is =  1.4917e-05
Total DO computing time in hours is =  9.9444e-06
Remaining DO computing time in min is =  0.00034308
Remaining DO computing time in hours is =  5.7181e-06
Remaining DO computing time in days is =  2.3825e-07
===============================================================================
===============================================================================
current DO iteration is 18
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809   -0.0001
    2.0000    0.1978         0
    3.0000    0.4143   -0.0001
    4.0000    0.8859         0

-------------------------------------
Computing time of each DO iteration in min is =  1.6933e-05
Total DO computing time in hours is =  1.1289e-05
Remaining DO computing time in min is =  0.00037253
Remaining DO computing time in hours is =  6.2089e-06
Remaining DO computing time in days is =  2.587e-07
===============================================================================
===============================================================================
current DO iteration is 19
current function value -677.8355
current step size 1
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0000
    2.0000    0.1978    0.0001
    3.0000    0.4143         0
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.5032e-05
Total DO computing time in hours is =  1.0021e-05
Remaining DO computing time in min is =  0.00031566
Remaining DO computing time in hours is =  5.2611e-06
Remaining DO computing time in days is =  2.1921e-07
===============================================================================
===============================================================================
current DO iteration is 20
current function value -677.8355
current step size 0.0625
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0000
    2.0000    0.1978         0
    3.0000    0.4143    0.0000
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.718e-05
Total DO computing time in hours is =  1.1453e-05
Remaining DO computing time in min is =  0.0003436
Remaining DO computing time in hours is =  5.7267e-06
Remaining DO computing time in days is =  2.3861e-07
===============================================================================
===============================================================================
current DO iteration is 21
current function value -677.8355
current step size 0.015625
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0000
    2.0000    0.1978         0
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.8368e-05
Total DO computing time in hours is =  1.2246e-05
Remaining DO computing time in min is =  0.000349
Remaining DO computing time in hours is =  5.8166e-06
Remaining DO computing time in days is =  2.4236e-07
===============================================================================
===============================================================================
current DO iteration is 22
current function value -677.8355
current step size 3.0518e-05
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0001
    2.0000    0.1978    0.0002
    3.0000    0.4143         0
    4.0000    0.8859         0

-------------------------------------
Computing time of each DO iteration in min is =  2.369e-05
Total DO computing time in hours is =  1.5793e-05
Remaining DO computing time in min is =  0.00042642
Remaining DO computing time in hours is =  7.107e-06
Remaining DO computing time in days is =  2.9613e-07
===============================================================================
===============================================================================
current DO iteration is 23
current function value -677.8355
current step size 0.0078125
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0001
    2.0000    0.1978    0.0001
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.8805e-05
Total DO computing time in hours is =  1.2537e-05
Remaining DO computing time in min is =  0.00031968
Remaining DO computing time in hours is =  5.3281e-06
Remaining DO computing time in days is =  2.22e-07
===============================================================================
===============================================================================
current DO iteration is 24
current function value -677.8355
current step size 0.015625
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0000
    2.0000    0.1978    0.0001
    3.0000    0.4143    0.0000
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.8257e-05
Total DO computing time in hours is =  1.2171e-05
Remaining DO computing time in min is =  0.00029211
Remaining DO computing time in hours is =  4.8684e-06
Remaining DO computing time in days is =  2.0285e-07
===============================================================================
===============================================================================
current DO iteration is 25
current function value -677.8355
current step size 0.00024414
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0001
    2.0000    0.1978         0
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  2.1788e-05
Total DO computing time in hours is =  1.4526e-05
Remaining DO computing time in min is =  0.00032682
Remaining DO computing time in hours is =  5.4471e-06
Remaining DO computing time in days is =  2.2696e-07
===============================================================================
===============================================================================
current DO iteration is 26
current function value -677.8355
current step size 0.0625
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809         0
    2.0000    0.1978    0.0001
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  1.7578e-05
Total DO computing time in hours is =  1.1719e-05
Remaining DO computing time in min is =  0.0002461
Remaining DO computing time in hours is =  4.1016e-06
Remaining DO computing time in days is =  1.709e-07
===============================================================================
===============================================================================
current DO iteration is 27
current function value -677.8355
current step size 1.9073e-06
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0002
    2.0000    0.1978    0.0002
    3.0000    0.4143    0.0000
    4.0000    0.8859         0

-------------------------------------
Computing time of each DO iteration in min is =  2.6378e-05
Total DO computing time in hours is =  1.7586e-05
Remaining DO computing time in min is =  0.00034292
Remaining DO computing time in hours is =  5.7153e-06
Remaining DO computing time in days is =  2.3814e-07
===============================================================================
===============================================================================
current DO iteration is 28
current function value -677.8355
current step size 0.00012207
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0001
    2.0000    0.1978    0.0001
    3.0000    0.4143    0.0000
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  2.245e-05
Total DO computing time in hours is =  1.4967e-05
Remaining DO computing time in min is =  0.0002694
Remaining DO computing time in hours is =  4.49e-06
Remaining DO computing time in days is =  1.8708e-07
===============================================================================
===============================================================================
current DO iteration is 29
current function value -677.8355
current step size 0
-------------------------------------
     indices  argmax    gradient
-------------------------------------
    1.0000    0.2809    0.0001
    2.0000    0.1978    0.0002
    3.0000    0.4143    0.0001
    4.0000    0.8859    0.0000

-------------------------------------
Computing time of each DO iteration in min is =  2.8102e-05
Total DO computing time in hours is =  1.8734e-05
Remaining DO computing time in min is =  0.00030912
Remaining DO computing time in hours is =  5.152e-06
Remaining DO computing time in days is =  2.1467e-07
===============================================================================
==================================
final function value	is -677.8355
----------------------------------
indices  argmax 
    1.0000    0.2809
    2.0000    0.1978
    3.0000    0.4143
    4.0000    0.8859

==================================
</pre><h2 id="4">Step 3: Results %%</h2><pre class="codeinput">disp(<span class="string">'========================================='</span>);
disp([<span class="string">'  Estimates '</span>,<span class="string">'  t value '</span>, <span class="string">'  p value '</span>]);
disp(<span class="string">'========================================='</span>);
disp([thetamx t_val p_val]);
disp(<span class="string">'========================================='</span>);
</pre><pre class="codeoutput">=========================================
  Estimates   t value   p value 
=========================================
    0.2809    3.9004    0.0001
    0.1978   10.7618         0
    0.4143   10.1511         0
    0.8859   15.7947         0

=========================================
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2022b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Maximum likelihood estimation
% Autocorrelation
% Y(t) = b1 + b2*x2(t) + e(t)
% e(t) = rho*e(t-1) + v(t), v(t)


clear;
clc;
addpath('C:\Users\이건희\OneDrive - 전북대학교\문서\MATLAB\M_library');

%% Step 1: DGP %%
T = 500;
sig2 = 1;
rho = 0.5;
b1 = 0.3;
b2 = 0.2;

x1m = ones(T,1);
x2m = randn(T,1)*2;

em = zeros(T,1);
ym = zeros(T,1);
eL = sqrt(sig2/(1-rho))*randn(1,1);
for t = 1:T
   
    et = rho*eL + sqrt(sig2)*randn(1,1);     
    yt = b1*x1m(t) + b2*x2m(t) + et;
    
    em(t) = et;
    ym(t) = yt;
    
    eL = et;
end


%% Step 2: Estimation %%
% Data
Y = ym; 
X = [x1m x2m]; 

Data = [Y X];

T = rows(X);
k = cols(X);

% initial value 
theta0 = [0;0;0.1;0.1];

% index
index = [1;2;3;4];
printi = 1;

% Optimization
[thetamx, fmax, Vj, Vinv] = SA_Newton(@lnlik,@paramconst,theta0,Data,printi,index);

% Compute t-value and p-value
diag_cov = diag(Vj);
stde = sqrt(diag_cov);
t_val = thetamx./stde; 
p_val = 2*(1 - cdf('t', abs(t_val), T-k)); 

%% Step 3: Results %%
disp('=========================================');
disp(['  Estimates ','  t value ', '  p value ']); 
disp('=========================================');
disp([thetamx t_val p_val]); 
disp('=========================================');

##### SOURCE END #####
--></body></html>